# 家庭星座分析后端

## 功能特性

### 1. 基础文字分析
- 接收家庭成员的文字描述
- 基于海灵格家庭星座理论进行分析
- 提供心理分析和建议

### 2. 截图增强分析 ⭐ 新功能
- 接收前端发送的画布截图
- 分析成员的空间位置关系
- 识别性别区分（方框男性，圆框女性）
- 分析已故成员的影响
- 提供更详细的结构化分析报告

## API 端点

### POST /analyze
主要分析端点，支持两种模式：

#### 仅文字分析
```json
{
  "description": "父亲（张三）位于(100, 100)，母亲（李四）位于(200, 200)..."
}
```

#### 截图增强分析
```json
{
  "description": "父亲（张三）位于(100, 100)，母亲（李四）位于(200, 200)...",
  "screenshot": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="
}
```

### POST /test-screenshot
测试截图处理功能：
```json
{
  "screenshot": "data:image/png;base64,..."
}
```

## 分析内容

### 截图分析包含：
1. **空间位置分析**
   - 成员间距离和相对位置
   - 中心vs边缘位置的意义
   - 排列模式（直线、三角形、分散等）

2. **性别区分分析**
   - 男性成员（方框）排列特点
   - 女性成员（圆框）排列特点
   - 性别角色在家庭系统中的体现

3. **已故成员影响**
   - 灰色叉号标记成员的影响
   - 已故成员在家庭中的"存在"意义
   - 对生者的情感影响

4. **情感关系解读**
   - 通过位置反映的亲疏关系
   - 成员间的连接和分离
   - 情感距离的视觉表现

5. **家庭系统平衡**
   - 缺失成员分析
   - 重复或排除成员分析
   - 系统完整性和平衡性

## 安装依赖

```bash
pip install -r requirements.txt
```

## 启动服务

```bash
python app.py
```

服务将在 http://127.0.0.1:5000 启动

## 测试

运行测试脚本：
```bash
python test_screenshot.py
``` 