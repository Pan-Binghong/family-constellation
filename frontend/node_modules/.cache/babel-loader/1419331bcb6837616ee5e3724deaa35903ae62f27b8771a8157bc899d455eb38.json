{"ast":null,"code":"var _jsxFileName = \"/Users/lujiayi/intern/hailingge/frontend/src/Canvas.js\",\n  _s = $RefreshSig$();\nimport React, { forwardRef } from 'react';\nimport { useDrop } from 'react-dnd';\nimport FamilyMember from './FamilyMember';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CANVAS_WIDTH = 1200;\nconst CANVAS_HEIGHT = 500;\nconst MEMBER_SIZE = 90;\nconst Canvas = /*#__PURE__*/_s(/*#__PURE__*/forwardRef(_c = _s(({\n  members,\n  updateMemberPosition,\n  onUpdateMember\n}, ref) => {\n  _s();\n  const [, drop] = useDrop({\n    accept: 'MEMBER',\n    drop: (item, monitor) => {\n      const clientOffset = monitor.getClientOffset();\n      const canvas = document.getElementById('canvas-area');\n      if (!clientOffset || !canvas) return;\n      const canvasRect = canvas.getBoundingClientRect();\n\n      // 计算鼠标在画布内的相对位置\n      const relativeX = clientOffset.x - canvasRect.left;\n      const relativeY = clientOffset.y - canvasRect.top;\n\n      // 以成员中心为基准，计算成员的左上角坐标\n      let x = relativeX - MEMBER_SIZE / 2;\n      let y = relativeY - MEMBER_SIZE / 2;\n\n      // 确保成员完全在画布内\n      x = Math.max(0, Math.min(x, CANVAS_WIDTH - MEMBER_SIZE));\n      y = Math.max(0, Math.min(y, CANVAS_HEIGHT - MEMBER_SIZE));\n      updateMemberPosition(item.id, x, y);\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"canvas-area\",\n    ref: node => {\n      drop(node);\n      if (ref) {\n        if (typeof ref === 'function') ref(node);else ref.current = node;\n      }\n    },\n    style: {\n      width: CANVAS_WIDTH,\n      height: CANVAS_HEIGHT,\n      background: '#fff',\n      border: '2px solid #000',\n      position: 'relative'\n    },\n    children: members.map(member => /*#__PURE__*/_jsxDEV(FamilyMember, {\n      member: member,\n      onUpdate: onUpdateMember\n    }, member.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 9\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 5\n  }, this);\n}, \"hdmCamxlwL9WeSdzgzIVyaE48AI=\", false, function () {\n  return [useDrop];\n})), \"hdmCamxlwL9WeSdzgzIVyaE48AI=\", false, function () {\n  return [useDrop];\n});\n_c2 = Canvas;\nexport default Canvas;\nvar _c, _c2;\n$RefreshReg$(_c, \"Canvas$forwardRef\");\n$RefreshReg$(_c2, \"Canvas\");","map":{"version":3,"names":["React","forwardRef","useDrop","FamilyMember","jsxDEV","_jsxDEV","CANVAS_WIDTH","CANVAS_HEIGHT","MEMBER_SIZE","Canvas","_s","_c","members","updateMemberPosition","onUpdateMember","ref","drop","accept","item","monitor","clientOffset","getClientOffset","canvas","document","getElementById","canvasRect","getBoundingClientRect","relativeX","x","left","relativeY","y","top","Math","max","min","id","node","current","style","width","height","background","border","position","children","map","member","onUpdate","fileName","_jsxFileName","lineNumber","columnNumber","_c2","$RefreshReg$"],"sources":["/Users/lujiayi/intern/hailingge/frontend/src/Canvas.js"],"sourcesContent":["import React, { forwardRef } from 'react';\nimport { useDrop } from 'react-dnd';\nimport FamilyMember from './FamilyMember';\n\nconst CANVAS_WIDTH = 1200;\nconst CANVAS_HEIGHT = 500;\nconst MEMBER_SIZE = 90;\n\nconst Canvas = forwardRef(({ members, updateMemberPosition, onUpdateMember }, ref) => {\n  const [, drop] = useDrop({\n    accept: 'MEMBER',\n    drop: (item, monitor) => {\n      const clientOffset = monitor.getClientOffset();\n      const canvas = document.getElementById('canvas-area');\n      if (!clientOffset || !canvas) return;\n      const canvasRect = canvas.getBoundingClientRect();\n\n      // 计算鼠标在画布内的相对位置\n      const relativeX = clientOffset.x - canvasRect.left;\n      const relativeY = clientOffset.y - canvasRect.top;\n\n      // 以成员中心为基准，计算成员的左上角坐标\n      let x = relativeX - MEMBER_SIZE / 2;\n      let y = relativeY - MEMBER_SIZE / 2;\n\n      // 确保成员完全在画布内\n      x = Math.max(0, Math.min(x, CANVAS_WIDTH - MEMBER_SIZE));\n      y = Math.max(0, Math.min(y, CANVAS_HEIGHT - MEMBER_SIZE));\n\n      updateMemberPosition(item.id, x, y);\n    }\n  });\n\n  return (\n    <div\n      id=\"canvas-area\"\n      ref={node => {\n        drop(node);\n        if (ref) {\n          if (typeof ref === 'function') ref(node);\n          else ref.current = node;\n        }\n      }}\n      style={{\n        width: CANVAS_WIDTH,\n        height: CANVAS_HEIGHT,\n        background: '#fff',\n        border: '2px solid #000',\n        position: 'relative'\n      }}\n    >\n      {members.map(member => (\n        <FamilyMember key={member.id} member={member} onUpdate={onUpdateMember} />\n      ))}\n    </div>\n  );\n});\n\nexport default Canvas;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,UAAU,QAAQ,OAAO;AACzC,SAASC,OAAO,QAAQ,WAAW;AACnC,OAAOC,YAAY,MAAM,gBAAgB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1C,MAAMC,YAAY,GAAG,IAAI;AACzB,MAAMC,aAAa,GAAG,GAAG;AACzB,MAAMC,WAAW,GAAG,EAAE;AAEtB,MAAMC,MAAM,gBAAAC,EAAA,cAAGT,UAAU,CAAAU,EAAA,GAAAD,EAAA,CAAC,CAAC;EAAEE,OAAO;EAAEC,oBAAoB;EAAEC;AAAe,CAAC,EAAEC,GAAG,KAAK;EAAAL,EAAA;EACpF,MAAM,GAAGM,IAAI,CAAC,GAAGd,OAAO,CAAC;IACvBe,MAAM,EAAE,QAAQ;IAChBD,IAAI,EAAEA,CAACE,IAAI,EAAEC,OAAO,KAAK;MACvB,MAAMC,YAAY,GAAGD,OAAO,CAACE,eAAe,CAAC,CAAC;MAC9C,MAAMC,MAAM,GAAGC,QAAQ,CAACC,cAAc,CAAC,aAAa,CAAC;MACrD,IAAI,CAACJ,YAAY,IAAI,CAACE,MAAM,EAAE;MAC9B,MAAMG,UAAU,GAAGH,MAAM,CAACI,qBAAqB,CAAC,CAAC;;MAEjD;MACA,MAAMC,SAAS,GAAGP,YAAY,CAACQ,CAAC,GAAGH,UAAU,CAACI,IAAI;MAClD,MAAMC,SAAS,GAAGV,YAAY,CAACW,CAAC,GAAGN,UAAU,CAACO,GAAG;;MAEjD;MACA,IAAIJ,CAAC,GAAGD,SAAS,GAAGnB,WAAW,GAAG,CAAC;MACnC,IAAIuB,CAAC,GAAGD,SAAS,GAAGtB,WAAW,GAAG,CAAC;;MAEnC;MACAoB,CAAC,GAAGK,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACE,GAAG,CAACP,CAAC,EAAEtB,YAAY,GAAGE,WAAW,CAAC,CAAC;MACxDuB,CAAC,GAAGE,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACE,GAAG,CAACJ,CAAC,EAAExB,aAAa,GAAGC,WAAW,CAAC,CAAC;MAEzDK,oBAAoB,CAACK,IAAI,CAACkB,EAAE,EAAER,CAAC,EAAEG,CAAC,CAAC;IACrC;EACF,CAAC,CAAC;EAEF,oBACE1B,OAAA;IACE+B,EAAE,EAAC,aAAa;IAChBrB,GAAG,EAAEsB,IAAI,IAAI;MACXrB,IAAI,CAACqB,IAAI,CAAC;MACV,IAAItB,GAAG,EAAE;QACP,IAAI,OAAOA,GAAG,KAAK,UAAU,EAAEA,GAAG,CAACsB,IAAI,CAAC,CAAC,KACpCtB,GAAG,CAACuB,OAAO,GAAGD,IAAI;MACzB;IACF,CAAE;IACFE,KAAK,EAAE;MACLC,KAAK,EAAElC,YAAY;MACnBmC,MAAM,EAAElC,aAAa;MACrBmC,UAAU,EAAE,MAAM;MAClBC,MAAM,EAAE,gBAAgB;MACxBC,QAAQ,EAAE;IACZ,CAAE;IAAAC,QAAA,EAEDjC,OAAO,CAACkC,GAAG,CAACC,MAAM,iBACjB1C,OAAA,CAACF,YAAY;MAAiB4C,MAAM,EAAEA,MAAO;MAACC,QAAQ,EAAElC;IAAe,GAApDiC,MAAM,CAACX,EAAE;MAAAa,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAA6C,CAC1E;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACC,CAAC;AAEV,CAAC;EAAA,QA/CkBlD,OAAO;AAAA,EA+CzB,CAAC;EAAA,QA/CiBA,OAAO;AAAA,EA+CxB;AAACmD,GAAA,GAhDG5C,MAAM;AAkDZ,eAAeA,MAAM;AAAC,IAAAE,EAAA,EAAA0C,GAAA;AAAAC,YAAA,CAAA3C,EAAA;AAAA2C,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}